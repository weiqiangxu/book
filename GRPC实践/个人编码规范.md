# 个人编码规范


### 代码细节

1. 枚举值注释必须完善
2. 禁止出现硬编码
3. 有基本的单元测试验证（尽量使用断言而不是手动log人工判定单测是否通过）
4. 接口粒度应该细小、接口依赖应该明确、接口入参出参应该明确，对象化，最好可以做到依赖抽象而不是直接依赖具体的实现
5. 禁止在接口之中有隐藏的依赖条件（入参之中没有的参数比如环境变量，入参应该是决定输出的唯一条件）
6. 接口逻辑应该尽可能简化，如果实在过于多自定义逻辑，应该对接口进行拆分，确保大接口拆出的小接口都走单元测试
7. 禁止IDE右侧出现notice黄色告警（单词拼写错误、命名不规范、公有方法没注释等）
8. 所有的指针访问都需要判定是否为nil
9. 所有的数组访问都需要判定length防止数组越界
10. 所有的除数都要判定被除数不是0
11. 关于同步转异步，如果是接口响应不强依赖执行结果的，比如用户关注频道后发送欢迎语，关注成功后异步发送欢迎语即可，不能阻塞主要流程，因为用户端不强依赖欢迎语
12. 包命名
13. 禁止滥用init
14. 禁止滥用全局变量，应该保证依赖的关系足够清晰明了
15. 包与包之间的依赖关系清晰(按功能分块按业务水平分层按数据垂直分层，每一层之间尽可能解耦)
16. 包的依赖应当尽可能是外部手动注入内部(选项模式注入私有属性) 而不是胡乱互相引用，比如user.service不能直接内部func进行new school.service 必须通过外部注入私有属性，这一点对于包依赖管理、各个分层解耦合很重要，也有利于单元测试覆盖
17. 函数禁止超过50行，如果过长应该考虑适当拆分
18. 任何有可能或者极大可能有扩展需求的接口应该考虑扩展性（设计模式的应用）

### 架构设计角度

1. 微服务之间解耦（mongodb/MySQL数据库层隔离、redis隔离(key业务划分/微服务之间隔离))
2. 禁止随意将其他微服务依赖的数据库写入到正在开发的微服务配置，业务数据访问走GRPC
3. 错误日志的错误信息严格按照标准(logger)
